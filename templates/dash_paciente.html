<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Área do Paciente | L'Odontologie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gold-border { border-color: #bf9b30; }
        .gold-text { color: #bf9b30; }
        .gold-bg { background-color: #bf9b30; }
        
        .radio-card:checked + div {
            border-color: #bf9b30;
            background-color: #fffbeb;
            color: #bf9b30;
            transform: scale(1.02);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .input-locked {
            background-color: transparent;
            border-color: transparent;
            color: #4b5563;
            cursor: default;
            font-weight: 500;
        }
        .input-editable {
            background-color: #ffffff;
            border-color: #e5e7eb;
            color: #000000;
        }
        .input-editable:focus {
            border-color: #bf9b30;
            outline: none;
            box-shadow: 0 0 0 3px rgba(191, 155, 48, 0.1);
        }

        .fade-out { animation: fadeOut 1s forwards; animation-delay: 4s; }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; visibility: hidden; } }

        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        body { padding-bottom: 80px; } 
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800 flex flex-col md:flex-row min-h-screen">

    <aside class="w-64 bg-white shadow-xl z-10 hidden md:flex flex-col justify-between fixed h-full border-r border-gray-100">
        <div>
            <div class="p-8 text-center border-b border-gray-50">
                <h1 class="font-serif text-xl font-bold tracking-widest text-gray-900">L'ODONTOLOGIE</h1>
                <p class="text-[10px] text-gray-400 uppercase tracking-[0.2em] mt-1">Portal do Paciente</p>
            </div>
            
            <div class="p-6 text-center">
                <div class="relative w-20 h-20 mx-auto mb-3">
                    <img src="{{ current_user.foto_perfil }}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'" class="w-full h-full rounded-full object-cover border-2 border-gray-200 shadow-sm">
                </div>
                <p class="font-bold text-sm text-gray-800">{{ current_user.nome }}</p>
                <p class="text-xs text-gray-400 mt-1 truncate">{{ current_user.email }}</p>
            </div>

            <nav class="mt-2 space-y-1 px-4">
                <a onclick="showTab('home')" class="cursor-pointer block p-3 px-4 text-sm font-medium text-gray-500 hover:text-black hover:bg-gray-50 rounded-lg transition flex items-center gap-3">
                    <i class="fas fa-home w-4 text-center"></i> Início
                </a>
                <a onclick="showTab('agendar')" class="cursor-pointer block p-3 px-4 text-sm font-medium text-gray-500 hover:text-black hover:bg-gray-50 rounded-lg transition flex items-center gap-3">
                    <i class="fas fa-calendar-plus w-4 text-center"></i> Agendar Consulta
                </a>
                <a onclick="showTab('perfil')" class="cursor-pointer block p-3 px-4 text-sm font-medium text-gray-500 hover:text-black hover:bg-gray-50 rounded-lg transition flex items-center gap-3">
                    <i class="fas fa-user-edit w-4 text-center"></i> Meus Dados
                </a>
            </nav>
        </div>
        <div class="p-6 border-t border-gray-50">
            <a href="/logout" class="flex items-center justify-center gap-2 w-full py-2 text-xs font-bold text-red-400 hover:text-red-600 transition bg-red-50 hover:bg-red-100 rounded-lg">
                <i class="fas fa-sign-out-alt"></i> SAIR
            </a>
        </div>
    </aside>

    <div class="md:hidden bg-white/95 backdrop-blur-md p-4 shadow-sm flex justify-between items-center sticky top-0 z-40 border-b border-gray-100">
        <div class="flex items-center gap-3">
            <img src="{{ current_user.foto_perfil }}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'" class="w-9 h-9 rounded-full border border-gray-200 object-cover">
            <div>
                <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest">Paciente</p>
                <p class="text-sm font-bold leading-none">{{ current_user.nome.split()[0] }}</p>
            </div>
        </div>
        <a href="/logout" class="text-gray-400 hover:text-red-500"><i class="fas fa-sign-out-alt"></i></a>
    </div>

    <main class="flex-1 md:ml-64 p-4 md:p-10 max-w-7xl mx-auto w-full">
        
        {% if erro %}
        <div class="fade-out fixed top-4 right-4 z-50 bg-white border-l-4 border-red-500 text-red-700 p-4 rounded shadow-2xl flex items-center gap-3 min-w-[300px]">
            <i class="fas fa-exclamation-triangle text-xl"></i>
            <div><p class="font-bold text-sm">Atenção</p><p class="text-xs">{{ erro }}</p></div>
        </div>
        {% endif %}

        {% if sucesso %}
        <div class="fade-out fixed top-4 right-4 z-50 bg-white border-l-4 border-green-500 text-green-800 p-4 rounded shadow-2xl flex items-center gap-3 min-w-[300px]">
            <i class="fas fa-check-circle text-green-600 text-xl"></i>
            <div><p class="font-bold text-sm">Sucesso</p><p class="text-xs">{{ sucesso }}</p></div>
        </div>
        {% endif %}

        <div id="home" class="tab-content">
            <div class="flex justify-between items-end mb-8">
                <div>
                    <h2 class="text-2xl font-serif font-bold text-gray-900">Minha Agenda</h2>
                    <p class="text-sm text-gray-500">Gerencie seus compromissos</p>
                </div>
                <button onclick="showTab('agendar')" class="bg-black text-white px-5 py-2.5 rounded-lg text-xs font-bold shadow hover:bg-[#bf9b30] transition flex items-center gap-2">
                    <i class="fas fa-plus"></i> Novo Agendamento
                </button>
            </div>
            
            {% if futuras %}
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {% for item in futuras %}
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden relative group hover:shadow-md transition">
                        <div class="absolute left-0 top-0 h-full w-1.5 bg-[#bf9b30]"></div>
                        <div class="p-6 pl-8">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <div class="flex items-baseline gap-1">
                                        <span class="text-4xl font-serif font-bold text-gray-900">{{ item.data_hora.strftime('%d') }}</span>
                                        <span class="text-sm font-bold text-[#bf9b30] uppercase">{{ item.data_hora.strftime('%b') }}</span>
                                    </div>
                                    <p class="text-sm text-gray-500 font-medium flex items-center gap-1 mt-1">
                                        <i class="far fa-clock text-xs"></i> {{ item.data_hora.strftime('%H:%M') }}
                                    </p>
                                </div>
                                <div class="flex -space-x-3">
                                    <img src="{{ item.dentista.foto_perfil }}" class="w-10 h-10 rounded-full border-2 border-white object-cover shadow-sm bg-gray-100" title="Dr. {{ item.dentista.nome }}">
                                    <img src="{{ current_user.foto_perfil }}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'" class="w-10 h-10 rounded-full border-2 border-white object-cover shadow-sm bg-gray-100" title="Você">
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="font-bold text-lg leading-tight">{{ item.servico }}</h3>
                                <p class="text-xs text-gray-500 mt-1">Com Dr(a). {{ item.dentista.nome }}</p>
                                <p class="text-xs text-gray-400 mt-0.5">{{ item.clinica.nome }}</p>
                            </div>

                            <form method="POST" onsubmit="return confirm('Deseja realmente cancelar este horário? Esta ação não pode ser desfeita.')">
                                <input type="hidden" name="acao" value="cancelar">
                                <input type="hidden" name="id_agendamento" value="{{ item.id }}">
                                <button class="w-full py-2 border border-gray-200 rounded-lg text-xs font-bold text-gray-400 hover:border-red-500 hover:text-red-500 hover:bg-red-50 transition">
                                    Cancelar Consulta
                                </button>
                            </form>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="bg-white p-12 text-center rounded-xl border border-dashed border-gray-300">
                    <div class="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300">
                        <i class="far fa-calendar-check text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900">Agenda Livre</h3>
                    <p class="text-gray-500 text-sm mt-1">Você não possui consultas agendadas para os próximos dias.</p>
                </div>
            {% endif %}

            <div class="mt-12">
                <h3 class="text-xs font-bold uppercase text-gray-400 mb-4 tracking-wider border-b pb-2">Histórico & Status</h3>
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 divide-y divide-gray-50">
                    {% for item in passadas %}
                    <div class="p-4 flex justify-between items-center hover:bg-gray-50 transition">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-full flex items-center justify-center {% if 'Cancelado' in item.status %} bg-red-50 text-red-500 {% else %} bg-green-50 text-green-600 {% endif %}">
                                <i class="fas {% if 'Cancelado' in item.status %} fa-ban {% else %} fa-check {% endif %}"></i>
                            </div>
                            <div>
                                <p class="font-bold text-sm text-gray-800">{{ item.servico }}</p>
                                <p class="text-xs text-gray-500">{{ item.data_hora.strftime('%d/%m/%Y') }} • Dr. {{ item.dentista.nome }}</p>
                            </div>
                        </div>
                        <span class="text-[9px] font-bold px-2 py-1 rounded border {% if 'Cancelado' in item.status %} bg-red-50 text-red-500 border-red-200 {% else %} bg-gray-100 text-gray-500 border-gray-200 {% endif %}">
                            {{ item.status.upper() if 'Cancelado' in item.status else 'CONCLUÍDO' }}
                        </span>
                    </div>
                    {% else %}
                    <p class="p-6 text-sm text-gray-400 text-center italic">Nenhum histórico disponível.</p>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div id="agendar" class="tab-content hidden">
            <h2 class="text-2xl font-serif font-bold mb-2">Solicitar Agendamento</h2>
            <p class="text-sm text-gray-500 mb-8">Selecione o motivo da visita e sua preferência.</p>
            
            <form method="POST" class="max-w-5xl mx-auto">
                <input type="hidden" name="acao" value="agendar">

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <label class="cursor-pointer group">
                        <input type="radio" name="motivo_visual" value="Avaliação Geral" class="hidden radio-card" required checked>
                        <div class="border-2 border-gray-100 bg-white p-4 rounded-xl text-center hover:border-gray-300 transition group-hover:shadow-md h-full flex flex-col items-center justify-center gap-3">
                            <i class="fas fa-clipboard-check text-2xl text-gray-300 group-hover:text-[#bf9b30] transition"></i>
                            <span class="text-xs font-bold text-gray-600 group-hover:text-black">Avaliação</span>
                        </div>
                    </label>
                    <label class="cursor-pointer group">
                        <input type="radio" name="motivo_visual" value="Dor de Dente" class="hidden radio-card">
                        <div class="border-2 border-gray-100 bg-white p-4 rounded-xl text-center hover:border-gray-300 transition group-hover:shadow-md h-full flex flex-col items-center justify-center gap-3">
                            <i class="fas fa-tooth text-2xl text-gray-300 group-hover:text-red-500 transition"></i>
                            <span class="text-xs font-bold text-gray-600 group-hover:text-black">Dor / Urgência</span>
                        </div>
                    </label>
                    <label class="cursor-pointer group">
                        <input type="radio" name="motivo_visual" value="Estética" class="hidden radio-card">
                        <div class="border-2 border-gray-100 bg-white p-4 rounded-xl text-center hover:border-gray-300 transition group-hover:shadow-md h-full flex flex-col items-center justify-center gap-3">
                            <i class="fas fa-gem text-2xl text-gray-300 group-hover:text-blue-500 transition"></i>
                            <span class="text-xs font-bold text-gray-600 group-hover:text-black">Estética</span>
                        </div>
                    </label>
                    <label class="cursor-pointer group">
                        <input type="radio" name="motivo_visual" value="Ortodontia" class="hidden radio-card">
                        <div class="border-2 border-gray-100 bg-white p-4 rounded-xl text-center hover:border-gray-300 transition group-hover:shadow-md h-full flex flex-col items-center justify-center gap-3">
                            <i class="fas fa-ruler-combined text-2xl text-gray-300 group-hover:text-gray-600 transition"></i>
                            <span class="text-xs font-bold text-gray-600 group-hover:text-black">Aparelho</span>
                        </div>
                    </label>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    
                    <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg border border-gray-100 h-fit">
                        <div class="mb-5">
                            <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Especialista</label>
                            <select name="dentista" id="select-dentista" onchange="mostrarDetalhesDentista()" class="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-[#bf9b30] focus:border-[#bf9b30] block p-3.5">
                                <option value="" disabled selected>Selecione um profissional...</option>
                                {% for d in dentistas %}
                                <option value="{{ d.id }}">{{ d.nome }} - {{ d.especialidade }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="mb-5">
                            <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Unidade</label>
                            <select name="clinica" class="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-[#bf9b30] focus:border-[#bf9b30] block p-3.5">
                                {% for c in clinicas %}
                                <option value="{{ c.id }}">{{ c.nome }} - {{ c.bairro }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="grid grid-cols-2 gap-4 mb-8">
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Data</label>
                                <input type="date" name="data_dia" required class="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-[#bf9b30] focus:border-[#bf9b30] block p-3.5">
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Horário</label>
                                <select name="data_hora" class="w-full bg-gray-50 border border-gray-200 text-gray-900 text-sm rounded-lg focus:ring-[#bf9b30] focus:border-[#bf9b30] block p-3.5">
                                    <optgroup label="Manhã">
                                        <option value="08:00">08:00</option>
                                        <option value="09:00">09:00</option>
                                        <option value="10:00">10:00</option>
                                        <option value="11:00">11:00</option>
                                    </optgroup>
                                    <optgroup label="Tarde">
                                        <option value="13:00">13:00</option>
                                        <option value="14:00">14:00</option>
                                        <option value="15:00">15:00</option>
                                        <option value="16:00">16:00</option>
                                        <option value="17:00">17:00</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>

                        <button class="w-full bg-black text-white py-4 rounded-xl font-bold uppercase text-xs tracking-widest hover:bg-[#bf9b30] transition shadow-lg transform active:scale-[0.98]">
                            Confirmar Agendamento
                        </button>
                    </div>

                    <div id="area-preview-dentista">
                        
                        <div id="dentista-placeholder" class="hidden md:flex bg-gray-50 border-2 border-dashed border-gray-200 rounded-2xl h-full min-h-[300px] flex-col items-center justify-center text-gray-400 p-8 text-center">
                            <i class="fas fa-user-md text-5xl mb-4 text-gray-300"></i>
                            <p class="text-sm">Selecione um especialista para ver detalhes.</p>
                        </div>

                        {% for d in dentistas %}
                        <div id="info-dentista-{{ d.id }}" class="dentista-info hidden bg-white rounded-2xl shadow-xl overflow-hidden animate-fade-in border border-gray-100">
                            <div class="bg-gray-900 p-6 flex items-center gap-5">
                                <img src="{{ d.foto_perfil }}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/3774/3774299.png'" class="w-20 h-20 rounded-full border-4 gold-border object-cover bg-white">
                                <div>
                                    <h3 class="text-xl font-serif text-white">{{ d.nome }}</h3>
                                    <p class="gold-text text-xs uppercase tracking-widest font-bold">{{ d.especialidade }}</p>
                                </div>
                            </div>
                            
                            <div class="p-6">
                                <div class="mb-6">
                                    <p class="text-sm text-gray-600 italic">"{{ d.bio or 'Profissional especialista da clínica L\'Odontologie.' }}"</p>
                                </div>

                                <div>
                                    <h4 class="text-xs font-bold uppercase text-gray-400 mb-3 flex items-center justify-between">
                                        Último Trabalho
                                        <span class="bg-green-100 text-green-700 text-[9px] px-2 py-0.5 rounded-full uppercase font-bold">Verificado</span>
                                    </h4>
                                    
                                    {% if d.meus_posts %}
                                        {% set ultimo = d.meus_posts[0] %} 
                                        <div class="relative w-full h-48 rounded-xl overflow-hidden shadow-md group">
                                            <img src="{{ ultimo.imagem_arquivo }}" class="w-full h-full object-cover transform transition duration-700 group-hover:scale-105">
                                            <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/90 via-black/50 to-transparent p-4">
                                                <p class="text-white font-bold text-sm">{{ ultimo.titulo }}</p>
                                                <p class="text-gray-300 text-xs line-clamp-1">{{ ultimo.descricao }}</p>
                                            </div>
                                        </div>
                                    {% else %}
                                        <div class="bg-gray-50 p-6 rounded-xl text-center border border-gray-100 border-dashed">
                                            <p class="text-xs text-gray-400">Portfólio em atualização.</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}

                    </div>
                </div>
            </form>
        </div>

        <div id="perfil" class="tab-content hidden">
            <h2 class="text-2xl font-serif font-bold mb-6">Meus Dados</h2>
            
            <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                <div class="h-32 bg-gray-900 relative">
                    <div class="absolute inset-0 bg-gradient-to-r from-black to-gray-800 opacity-90"></div>
                    <div class="absolute bottom-6 left-8 text-white">
                        <p class="text-[10px] uppercase tracking-widest text-[#bf9b30] font-bold mb-1">Identificação</p>
                        <h3 class="text-xl font-serif">Ficha Cadastral</h3>
                    </div>
                </div>

                <div class="p-8 relative">
                    <div class="absolute -top-12 right-8 w-24 h-24 rounded-full border-4 border-white shadow-lg overflow-hidden bg-white">
                        <img src="{{ current_user.foto_perfil }}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'" class="w-full h-full object-cover">
                    </div>

                    <form id="form-perfil" method="POST" enctype="multipart/form-data" class="mt-4 space-y-6">
                        <input type="hidden" name="acao" value="perfil">
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-1">Nome Completo</label>
                                <input type="text" name="nome" id="nome" value="{{ current_user.nome }}" disabled class="input-locked w-full border-b border-gray-200 py-2 focus:border-[#bf9b30] outline-none transition-colors">
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-1">E-mail (Login)</label>
                                <input type="email" name="email" id="email" value="{{ current_user.email }}" disabled class="input-locked w-full border-b border-gray-200 py-2 focus:border-[#bf9b30] outline-none transition-colors">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-1">Celular / WhatsApp</label>
                                <input type="text" name="telefone" id="telefone" value="{{ current_user.telefone or '' }}" disabled placeholder="(00) 00000-0000" maxlength="15" class="input-locked w-full border-b border-gray-200 py-2 focus:border-[#bf9b30] outline-none transition-colors">
                            </div>
                            <div>
                                <label class="block text-xs font-bold uppercase text-gray-400 mb-1">Endereço Residencial</label>
                                <input type="text" name="endereco" id="endereco" value="{{ current_user.endereco or '' }}" disabled class="input-locked w-full border-b border-gray-200 py-2 focus:border-[#bf9b30] outline-none transition-colors">
                            </div>
                        </div>

                        <div id="campo-senha" class="hidden bg-gray-50 p-4 rounded-lg border border-gray-200 mt-2">
                            <label class="block text-xs font-bold uppercase text-gray-500 mb-2">Nova Senha (Opcional)</label>
                            <div class="relative">
                                <input type="password" name="senha" id="senha_input" placeholder="Deixe em branco para manter a atual" class="w-full bg-white border border-gray-300 rounded p-2 pr-10 text-sm focus:border-[#bf9b30] outline-none">
                                <i class="fas fa-eye absolute right-3 top-3 text-gray-400 cursor-pointer hover:text-black transition" onclick="toggleSenha()"></i>
                            </div>
                        </div>

                        <div id="campo-foto" class="hidden mt-4">
                            <label class="block text-xs font-bold uppercase text-gray-400 mb-2">Alterar Foto de Perfil</label>
                            <input type="file" name="foto_perfil" class="block w-full text-xs text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-semibold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200">
                        </div>

                        <div class="flex gap-4 mt-8 pt-4 border-t border-gray-50">
                            <button type="button" id="btn-editar" onclick="ativarEdicao()" class="px-6 py-2.5 border border-gray-300 rounded-lg text-sm font-bold text-gray-600 hover:bg-black hover:text-white hover:border-black transition">
                                <i class="fas fa-pencil-alt mr-2"></i> Editar Dados
                            </button>
                            
                            <button type="submit" id="btn-salvar" class="hidden px-6 py-2.5 bg-green-600 rounded-lg text-sm font-bold text-white hover:bg-green-700 transition shadow-lg w-full md:w-auto">
                                <i class="fas fa-check mr-2"></i> Salvar Alterações
                            </button>
                            
                            <button type="button" id="btn-cancelar" onclick="cancelarEdicao()" class="hidden px-6 py-2.5 border border-red-200 rounded-lg text-sm font-bold text-red-500 hover:bg-red-50 transition">
                                Cancelar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

    </main>

    <nav class="md:hidden fixed bottom-0 left-0 w-full bg-white/95 backdrop-blur shadow-[0_-4px_20px_rgba(0,0,0,0.05)] z-50 flex justify-around items-center py-3 border-t border-gray-100 pb-safe">
        <button onclick="showTab('home')" class="mobile-link flex flex-col items-center gap-1 text-[#bf9b30] w-1/4">
            <i class="fas fa-home text-lg"></i> <span class="text-[9px] font-bold">INÍCIO</span>
        </button>
        <button onclick="showTab('agendar')" class="mobile-link flex flex-col items-center gap-1 text-gray-400 hover:text-[#bf9b30] w-1/4">
            <i class="fas fa-calendar-plus text-lg"></i> <span class="text-[9px] font-bold">NOVO</span>
        </button>
        <button onclick="showTab('perfil')" class="mobile-link flex flex-col items-center gap-1 text-gray-400 hover:text-[#bf9b30] w-1/4">
            <i class="fas fa-user text-lg"></i> <span class="text-[9px] font-bold">PERFIL</span>
        </button>
    </nav>

    <script>
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            document.querySelectorAll('.mobile-link').forEach(btn => btn.classList.replace('text-[#bf9b30]', 'text-gray-400'));
        }

        function mostrarDetalhesDentista() {
            // CORREÇÃO: Garante que escondemos o placeholder removendo o flex e adicionando hidden
            const placeholder = document.getElementById('dentista-placeholder');
            placeholder.classList.remove('flex', 'md:flex'); 
            placeholder.classList.add('hidden');

            document.querySelectorAll('.dentista-info').forEach(el => el.classList.add('hidden'));
            
            const id = document.getElementById('select-dentista').value;
            if(id) {
                document.getElementById('info-dentista-' + id).classList.remove('hidden');
            } else {
                // Se não selecionou nada, mostra o placeholder de volta
                placeholder.classList.remove('hidden');
                placeholder.classList.add('hidden', 'md:flex'); // Garante que no mobile continue hidden
            }
        }

        function ativarEdicao() {
            ['nome', 'email', 'telefone', 'endereco'].forEach(id => {
                const el = document.getElementById(id);
                if(el) {
                    el.disabled = false;
                    el.classList.remove('input-locked');
                    el.classList.add('input-editable');
                }
            });
            document.getElementById('campo-foto').classList.remove('hidden');
            document.getElementById('campo-senha').classList.remove('hidden');
            
            document.getElementById('btn-editar').classList.add('hidden');
            document.getElementById('btn-salvar').classList.remove('hidden');
            document.getElementById('btn-cancelar').classList.remove('hidden');
        }

        function cancelarEdicao() { window.location.reload(); }

        // FUNÇÃO OLHO
        function toggleSenha() {
            const input = document.getElementById('senha_input');
            const icon = document.querySelector('.fa-eye, .fa-eye-slash');
            if (input.type === "password") {
                input.type = "text";
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = "password";
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        const telInput = document.getElementById('telefone');
        if(telInput) {
            telInput.addEventListener('input', e => {
                let v = e.target.value.replace(/\D/g, "").slice(0, 11);
                v = v.replace(/^(\d{2})(\d)/g, "($1) $2");
                v = v.replace(/(\d)(\d{4})$/, "$1-$2");
                e.target.value = v;
            });
        }

        setTimeout(() => { document.querySelectorAll('.fade-out').forEach(el => el.style.display = 'none'); }, 5000);
    </script>
</body>
</html>