<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Exclusive | L'Odontologie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Manrope:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'gold-primary': '#C6A87C',
                        'bg-body': '#F3F4F6',
                        'dark-card': '#1a1a1a'
                    },
                    fontFamily: {
                        serif: ['"Playfair Display"', 'serif'],
                        sans: ['"Manrope"', 'sans-serif']
                    }
                }
            }
        }

        function openTab(tabName) {
            let tabs = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.add("hidden");
            }
            document.getElementById(tabName).classList.remove("hidden");
            document.getElementById('mobile-menu').classList.add('-translate-x-full');
        }

        function toggleMenu() {
            document.getElementById('mobile-menu').classList.toggle('-translate-x-full');
        }

        // Função para sumir notificação após 4 segundos
        window.onload = function() {
            setTimeout(function() {
                let alerts = document.querySelectorAll('.alert-box');
                alerts.forEach(function(alert) {
                    alert.style.transition = "opacity 0.5s ease";
                    alert.style.opacity = "0";
                    setTimeout(() => alert.remove(), 500);
                });
            }, 4000);
        };
    </script>
    <style>
        .input-gold {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 0.75rem;
            width: 100%;
            transition: all 0.3s;
        }

        .input-gold:focus {
            border-color: #C6A87C;
            outline: none;
            box-shadow: 0 0 0 3px rgba(198, 168, 124, 0.1);
        }

        input[type="color"] {
            -webkit-appearance: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            cursor: pointer;
        }

        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }

        input[type="color"]::-webkit-color-swatch {
            border: none;
        }

        /* Estilo para o botão de Upload de Arquivo */
        input[type="file"] {
            font-size: 0.75rem;
            color: #6b7280;
        }

        input[type="file"]::file-selector-button {
            border: none;
            background: #f3f4f6;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            color: #4b5563;
            cursor: pointer;
            margin-right: 1rem;
            font-weight: bold;
            transition: all 0.3s;
        }

        input[type="file"]::file-selector-button:hover {
            background: #C6A87C;
            color: white;
        }
    </style>
</head>

<body class="bg-bg-body text-gray-800 font-sans antialiased h-screen flex overflow-hidden">

    <div id="mobile-menu" class="fixed inset-0 z-50 bg-white transform -translate-x-full transition-transform duration-300 md:hidden flex flex-col w-3/4 shadow-2xl">
        <div class="p-6 border-b border-gray-100 flex justify-between items-center">
            <span class="font-serif font-bold text-xl text-gold-primary">L'Odontologie</span>
            <button onclick="toggleMenu()" class="text-gray-400">
                <i class="fas fa-times text-2xl"></i>
            </button>
        </div>
        <nav class="flex-1 p-6 space-y-4 overflow-y-auto">
            <button onclick="openTab('dashboard')" class="w-full text-left font-bold text-gray-600 hover:text-gold-primary">Visão Geral</button>
            <button onclick="openTab('equipe')" class="w-full text-left font-bold text-gray-600 hover:text-gold-primary">Equipe Médica</button>
            <button onclick="openTab('agenda')" class="w-full text-left font-bold text-gray-600 hover:text-gold-primary">Agenda</button>
            <button onclick="openTab('site')" class="w-full text-left font-bold text-gray-600 hover:text-gold-primary">Editor Site</button>
            <button onclick="openTab('clinicas')" class="w-full text-left font-bold text-gray-600 hover:text-gold-primary">Unidades</button>
            <a href="/logout" class="block w-full text-left text-red-500 font-bold mt-4 border-t border-gray-100 pt-4">Sair</a>
        </nav>
    </div>

    <aside class="hidden md:flex w-72 bg-white border-r border-gray-200 flex-col justify-between shrink-0 z-20">
        <div>
            <div class="h-24 flex items-center px-8 border-b border-gray-100">
                <i class="fas fa-tooth text-2xl text-gold-primary mr-3"></i>
                <span class="font-serif font-bold tracking-widest text-sm">ADMINISTRATIVO</span>
            </div>
            <nav class="mt-8 px-4 space-y-2">
                <button onclick="openTab('dashboard')" class="w-full py-4 px-6 text-left text-xs font-bold uppercase tracking-widest rounded-xl hover:bg-orange-50 hover:text-gold-primary transition flex items-center gap-3 text-gray-500">
                    <i class="fas fa-chart-line w-5"></i> Dashboard
                </button>
                <button onclick="openTab('agenda')" class="w-full py-4 px-6 text-left text-xs font-bold uppercase tracking-widest rounded-xl hover:bg-orange-50 hover:text-gold-primary transition flex items-center gap-3 text-gray-500">
                    <i class="far fa-calendar-check w-5"></i> Agenda
                </button>
                <button onclick="openTab('equipe')" class="w-full py-4 px-6 text-left text-xs font-bold uppercase tracking-widest rounded-xl hover:bg-orange-50 hover:text-gold-primary transition flex items-center gap-3 text-gray-500">
                    <i class="fas fa-user-md w-5"></i> Especialistas
                </button>
                <button onclick="openTab('site')" class="w-full py-4 px-6 text-left text-xs font-bold uppercase tracking-widest rounded-xl hover:bg-orange-50 hover:text-gold-primary transition flex items-center gap-3 text-gray-500">
                    <i class="fas fa-swatchbook w-5"></i> Aparência
                </button>
                <button onclick="openTab('clinicas')" class="w-full py-4 px-6 text-left text-xs font-bold uppercase tracking-widest rounded-xl hover:bg-orange-50 hover:text-gold-primary transition flex items-center gap-3 text-gray-500">
                    <i class="fas fa-map-marker-alt w-5"></i> Unidades
                </button>
            </nav>
        </div>
        <div class="p-8">
            <a href="/logout" class="flex items-center gap-2 text-gray-400 hover:text-red-500 transition text-xs font-bold uppercase tracking-widest">
                <i class="fas fa-power-off"></i> Sair
            </a>
        </div>
    </aside>

    <main class="flex-1 flex flex-col h-full relative overflow-hidden">

        <header class="md:hidden h-16 bg-white border-b border-gray-200 flex items-center justify-between px-4 shrink-0">
            <button onclick="toggleMenu()" class="text-gray-600">
                <i class="fas fa-bars text-xl"></i>
            </button>
            <span class="font-serif font-bold text-gold-primary">L'Odontologie</span>
            <div class="w-6"></div>
        </header>

        <div class="flex-1 overflow-y-auto p-4 md:p-10 relative">

            {% if sucesso %}
            <div class="alert-box mb-6 bg-green-50 text-green-800 px-6 py-4 rounded-xl shadow-sm border border-green-100 flex items-center gap-3">
                <i class="fas fa-check-circle"></i> {{ sucesso }}
            </div>
            {% endif %}
            
            {% if erro %}
            <div class="alert-box mb-6 bg-red-50 text-red-800 px-6 py-4 rounded-xl shadow-sm border border-red-100 flex items-center gap-3">
                <i class="fas fa-exclamation-circle"></i> {{ erro }}
            </div>
            {% endif %}

            {% if afetados %}
            <div class="mb-8 bg-yellow-50 border border-yellow-200 rounded-3xl p-8 shadow-sm alert-box">
                <div class="flex items-center gap-3 mb-4">
                    <i class="fab fa-whatsapp text-3xl text-green-500"></i>
                    <h3 class="text-xl font-serif font-bold text-yellow-800">Avisar Pacientes Cancelados</h3>
                </div>
                <p class="text-sm text-yellow-700 mb-6">As consultas abaixo foram canceladas. Clique no ícone para enviar o aviso automático:</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    {% for a in afetados %}
                    <a href="{{ a.link }}" target="_blank" class="flex items-center justify-between bg-white p-4 rounded-xl border border-yellow-100 hover:shadow-md transition group">
                        <div>
                            <p class="font-bold text-gray-800 text-sm">{{ a.nome }}</p>
                            <p class="text-xs text-gray-400">Horário: {{ a.hora }}</p>
                        </div>
                        <div class="bg-green-100 text-green-600 w-8 h-8 rounded-full flex items-center justify-center group-hover:bg-green-500 group-hover:text-white transition">
                            <i class="fas fa-paper-plane text-xs"></i>
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div id="dashboard" class="tab-content {{ 'hidden' if active_tab != 'dashboard' else '' }}">
                <h1 class="text-3xl md:text-4xl font-serif text-gray-900 mb-2">Visão Geral</h1>
                <p class="text-gray-400 text-sm mb-8">Performance e Estatísticas da Clínica.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-10">
                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center text-xl">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div>
                            <p class="text-[10px] uppercase tracking-widest text-gray-400 font-bold">Hoje</p>
                            <h3 class="text-2xl font-bold">{{ stats.hoje }} <span class="text-xs font-normal text-gray-400">agendados</span></h3>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-green-50 text-green-500 flex items-center justify-center text-xl">
                            <i class="fas fa-check-double"></i>
                        </div>
                        <div>
                            <p class="text-[10px] uppercase tracking-widest text-gray-400 font-bold">Total Concluído</p>
                            <h3 class="text-2xl font-bold">{{ stats.total_concluidas }}</h3>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex flex-col justify-center gap-2">
                        <div class="flex justify-between items-center border-b border-gray-50 pb-2">
                            <span class="text-[10px] uppercase font-bold text-gray-400">Semana</span>
                            <span class="font-bold text-green-600">{{ stats.semana_concluidas }} <i class="fas fa-arrow-up text-[10px]"></i></span>
                        </div>
                        <div class="flex justify-between items-center pt-1">
                            <span class="text-[10px] uppercase font-bold text-gray-400">Mês</span>
                            <span class="font-bold text-gray-700">{{ stats.mes_concluidas }}</span>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100 flex flex-col justify-center gap-2 relative overflow-hidden">
                        <div class="absolute right-0 top-0 p-2 opacity-10">
                            <i class="fas fa-ban text-6xl text-red-500"></i>
                        </div>
                        <p class="text-[10px] uppercase tracking-widest text-red-400 font-bold mb-1">Cancelamentos</p>

                        <div class="flex justify-between items-center border-b border-gray-50 pb-2">
                            <span class="text-[10px] uppercase font-bold text-gray-400">Semana</span>
                            <span class="font-bold text-red-500">{{ stats.semana_canceladas }}</span>
                        </div>
                        <div class="flex justify-between items-center pt-1">
                            <span class="text-[10px] uppercase font-bold text-gray-400">Mês</span>
                            <span class="font-bold text-red-600">{{ stats.mes_canceladas }}</span>
                        </div>
                        <div class="mt-2 text-right">
                            <span class="text-[9px] text-gray-400">Total Histórico: {{ stats.total_canceladas }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="site" class="tab-content {{ 'hidden' if active_tab != 'site' else '' }}">
                <h2 class="text-3xl font-serif mb-6">Editor de Aparência</h2>

                <form method="POST" enctype="multipart/form-data" class="space-y-8">
                    <input type="hidden" name="acao" value="config_site">

                    <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100">
                        <h3 class="text-xs font-bold uppercase tracking-widest text-gold-primary mb-4">Página Inicial (Banner)</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase">Título Principal</label>
                                <div class="flex gap-2 mb-4">
                                    <input type="text" name="titulo_principal" value="{{ config.titulo_principal }}" class="input-gold flex-1">
                                    <input type="color" name="cor_titulo" value="{{ config.cor_titulo }}">
                                </div>

                                <label class="text-[10px] font-bold text-gray-400 uppercase">Texto Destaque</label>
                                <div class="flex gap-2 mb-4">
                                    <input type="text" name="titulo_destaque" value="{{ config.titulo_destaque }}" class="input-gold flex-1 italic">
                                    <input type="color" name="cor_destaque" value="{{ config.cor_destaque }}">
                                </div>

                                <label class="text-[10px] font-bold text-gray-400 uppercase">Descrição</label>
                                <div class="flex gap-2">
                                    <textarea name="subtitulo" rows="2" class="input-gold flex-1">{{ config.subtitulo }}</textarea>
                                    <input type="color" name="cor_subtitulo" value="{{ config.cor_subtitulo }}">
                                </div>
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase">Imagem de Fundo (Upload)</label>
                                <input type="file" name="img_agendamento" class="input-gold text-xs mb-2">
                                <img src="{{ config.img_agendamento }}" class="h-40 w-full object-cover rounded-xl opacity-80 border border-gray-200 bg-gray-100">
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100">
                        <h3 class="text-xs font-bold uppercase tracking-widest text-gold-primary mb-4">Seção: Sua Próxima Visita</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Título da Seção</label>
                                <input type="text" name="titulo_visita" value="{{ config.titulo_visita }}" class="input-gold mb-4">

                                <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Descrição do Serviço</label>
                                <textarea name="desc_visita" rows="3" class="input-gold">{{ config.desc_visita }}</textarea>
                            </div>
                            <div>
                                <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Imagem (Upload)</label>
                                <input type="file" name="img_visita" class="input-gold text-xs mb-2">
                                <img src="{{ config.img_visita }}" class="h-32 w-full object-cover rounded-xl border border-gray-200 bg-gray-100">
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100">
                            <h3 class="text-xs font-bold uppercase tracking-widest text-gold-primary mb-4">Seção: Equipe (Banner)</h3>
                            <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Imagem Fundo (Upload)</label>
                            <input type="file" name="img_especialistas" class="input-gold text-xs mb-4">
                            
                            <div class="flex gap-2 items-center justify-center p-4 bg-gray-50 rounded-xl border border-dashed border-gray-200">
                                {% for d in dentistas[:3] %}
                                <div class="flex flex-col items-center">
                                    <div class="w-10 h-10 rounded-full bg-gray-300 border-2 border-white shadow-sm overflow-hidden">
                                        <img src="{{ d.foto_perfil if d.foto_perfil else 'https://cdn-icons-png.flaticon.com/512/3774/3774299.png' }}" class="w-full h-full object-cover">
                                    </div>
                                    <span class="text-[8px] text-gray-500 mt-1">{{ d.nome.split()[0] }}</span>
                                </div>
                                {% endfor %}
                            </div>
                            <p class="text-[9px] text-gray-400 mt-2">* As fotos dos médicos são puxadas automaticamente.</p>
                        </div>

                        <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-gray-100">
                            <h3 class="text-xs font-bold uppercase tracking-widest text-gold-primary mb-4">Seção: Mapa</h3>
                            <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Título</label>
                            <input type="text" name="titulo_mapa" value="{{ config.titulo_mapa }}" class="input-gold mb-4">
                            <label class="text-[10px] font-bold text-gray-400 uppercase mb-1">Descrição</label>
                            <textarea name="desc_mapa" rows="3" class="input-gold">{{ config.desc_mapa }}</textarea>
                        </div>
                    </div>

                    <div class="pt-4 border-t border-gray-100 sticky bottom-0 bg-bg-body pb-4">
                        <button class="w-full md:w-auto bg-dark-card text-white px-8 py-3 rounded-xl font-bold uppercase tracking-widest hover:bg-gold-primary transition shadow-lg">
                            Salvar Alterações
                        </button>
                    </div>
                </form>
            </div>

            <div id="clinicas" class="tab-content {{ 'hidden' if active_tab != 'clinicas' else '' }}">
                <h2 class="text-3xl font-serif mb-6">Gerenciar Unidades</h2>

                <div class="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-gray-100 mb-8">
                    <form method="POST" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end">
                        <input type="hidden" name="acao" value="nova_clinica">
                        <div><label class="text-[10px] font-bold text-gray-400 uppercase">Nome</label><input type="text" name="nome" required class="input-gold"></div>
                        <div><label class="text-[10px] font-bold text-gray-400 uppercase">Bairro</label><input type="text" name="bairro" required class="input-gold"></div>
                        <div><label class="text-[10px] font-bold text-gray-400 uppercase">Endereço</label><input type="text" name="endereco" required class="input-gold"></div>
                        <div><label class="text-[10px] font-bold text-gray-400 uppercase">Telefone</label><input type="text" name="telefone" required class="input-gold"></div>
                        <button class="bg-gold-primary text-white h-[46px] rounded-lg font-bold uppercase text-xs hover:bg-black transition lg:col-span-4 mt-2">Adicionar Unidade</button>
                    </form>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {% for clinica in clinicas %}
                    <div class="bg-white p-6 rounded-[2rem] border border-gray-100 relative group hover:shadow-lg transition">
                        <div class="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition">
                            <form method="POST" onsubmit="return confirm('Excluir esta unidade permanentemente?');">
                                <input type="hidden" name="acao" value="excluir_clinica">
                                <input type="hidden" name="id_clinica" value="{{ clinica.id }}">
                                <button class="text-red-300 hover:text-red-600 bg-red-50 p-2 rounded-full"><i class="fas fa-trash-alt"></i></button>
                            </form>
                        </div>
                        <h4 class="font-bold text-lg mb-1">{{ clinica.nome }}</h4>
                        <span class="bg-gold-primary/10 text-gold-primary text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide">{{ clinica.bairro }}</span>
                        <div class="mt-4 space-y-2 text-sm text-gray-500">
                            <p><i class="fas fa-map-marker-alt w-5 text-center"></i> {{ clinica.endereco_completo }}</p>
                            <p><i class="fas fa-phone w-5 text-center"></i> {{ clinica.telefone }}</p>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div id="equipe" class="tab-content {{ 'hidden' if active_tab != 'equipe' else '' }}">
                <h2 class="text-3xl font-serif mb-6">Corpo Clínico</h2>

                <div class="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-gray-100 mb-8">
                    <h3 class="text-sm font-bold uppercase tracking-widest text-gold-primary mb-4">Novo Especialista</h3>
                    <form method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="hidden" name="acao" value="cadastrar_dentista">
                        <input type="text" name="nome" placeholder="Nome Completo" required class="input-gold">
                        <input type="email" name="email" placeholder="E-mail Profissional" required class="input-gold">
                        <input type="text" name="especialidade" placeholder="Especialidade" required class="input-gold">
                        <input type="text" name="telefone" placeholder="Telefone" class="input-gold">
                        <input type="password" name="senha" placeholder="Senha Provisória" value="123" required class="input-gold">
                        <button class="md:col-span-2 bg-dark-card text-white py-3 rounded-lg font-bold uppercase text-xs hover:bg-gold-primary transition">
                            Contratar (Foto pendente)
                        </button>
                    </form>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    {% for d in dentistas %}
                    <div class="bg-white p-6 rounded-[2rem] border border-gray-100 flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <img src="{{ d.foto_perfil if d.foto_perfil else 'https://cdn-icons-png.flaticon.com/512/3774/3774299.png' }}" class="w-12 h-12 rounded-full object-cover border border-gray-100">
                            <div>
                                <h4 class="font-bold">{{ d.nome }}</h4>
                                <p class="text-xs text-gray-400">{{ d.especialidade }}</p>
                            </div>
                        </div>
                        <form method="POST" onsubmit="return confirm('Demitir?');">
                            <input type="hidden" name="acao" value="excluir_user">
                            <input type="hidden" name="tipo_user" value="dentista">
                            <input type="hidden" name="id_user" value="{{ d.id }}">
                            <button class="text-gray-300 hover:text-red-500"><i class="fas fa-user-times"></i></button>
                        </form>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <div id="agenda" class="tab-content {{ 'hidden' if active_tab != 'agenda' else '' }}">
                <h2 class="text-3xl font-serif mb-6">Agenda Global</h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">

                    <div class="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-gray-100 h-full">
                        <h3 class="text-sm font-bold uppercase tracking-widest text-gold-primary mb-6 flex items-center gap-2">
                            <i class="fas fa-plus-circle"></i> Novo Agendamento
                        </h3>
                        <form method="POST" class="space-y-4">
                            <input type="hidden" name="acao" value="admin_agendar">

                            <div class="grid grid-cols-2 gap-4">
                                <div><label class="text-[10px] font-bold text-gray-400 uppercase">Buscar Paciente</label><input type="text" name="termo_busca" required class="input-gold"></div>
                                <div><label class="text-[10px] font-bold text-gray-400 uppercase">Dentista</label><select name="dentista_id" class="input-gold" required>{% for d in dentistas %}<option value="{{ d.id }}">{{ d.nome }}</option>{% endfor %}</select></div>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div><label class="text-[10px] font-bold text-gray-400 uppercase">Motivo</label><input type="text" name="servico" required class="input-gold"></div>
                                <div>
                                    <label class="text-[10px] font-bold text-gray-400 uppercase">Tipo</label>
                                    <select name="tipo_consulta" class="input-gold">
                                        <option value="Avaliação">Avaliação</option>
                                        <option value="Tratamento">Tratamento</option>
                                        <option value="Retorno">Retorno</option>
                                        <option value="Urgência">Urgência</option>
                                    </select>
                                </div>
                            </div>

                            <div><label class="text-[10px] font-bold text-gray-400 uppercase">Obs</label><textarea name="observacoes" rows="2" class="input-gold"></textarea></div>

                            <div class="grid grid-cols-2 gap-4">
                                <div><label class="text-[10px] font-bold text-gray-400 uppercase">Data</label><input type="date" name="data" class="input-gold" required></div>
                                <div>
                                    <label class="text-[10px] font-bold text-gray-400 uppercase">Hora</label>
                                    <select name="hora" class="input-gold" required>
                                        <option value="08:00">08:00</option>
                                        <option value="09:00">09:00</option>
                                        <option value="10:00">10:00</option>
                                        <option value="11:00">11:00</option>
                                        <option disabled>--- Almoço ---</option>
                                        <option value="13:00">13:00</option>
                                        <option value="14:00">14:00</option>
                                        <option value="15:00">15:00</option>
                                        <option value="16:00">16:00</option>
                                        <option value="17:00">17:00</option>
                                    </select>
                                </div>
                            </div>

                            <button class="bg-dark-card text-white w-full py-3 rounded-lg font-bold uppercase text-xs hover:bg-gold-primary transition mt-2">Confirmar</button>
                        </form>
                    </div>

                    <div class="bg-white p-6 md:p-8 rounded-[2rem] shadow-sm border border-red-50 h-full">
                        <h3 class="text-sm font-bold uppercase tracking-widest text-red-400 mb-6 flex items-center gap-2">
                            <i class="fas fa-ban"></i> Bloquear Dia
                        </h3>
                        <form method="POST" class="space-y-4">
                            <input type="hidden" name="acao" value="admin_bloquear">
                            <div><label class="text-[10px] font-bold text-gray-400 uppercase">Profissional</label><select name="dentista_id" class="input-gold" required>{% for d in dentistas %}<option value="{{ d.id }}">{{ d.nome }}</option>{% endfor %}</select></div>
                            <div><label class="text-[10px] font-bold text-gray-400 uppercase">Data</label><input type="date" name="data_bloqueio" class="input-gold" required></div>
                            <div><label class="text-[10px] font-bold text-gray-400 uppercase">Motivo</label><input type="text" name="motivo_bloqueio" required class="input-gold"></div>
                            <button class="bg-red-500 text-white w-full py-3 rounded-lg font-bold uppercase text-xs hover:bg-red-600 transition mt-auto">Bloquear e Cancelar</button>
                        </form>
                    </div>
                </div>

                <div class="bg-white rounded-[2rem] shadow-sm border border-gray-100 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse min-w-[800px]">
                            <thead class="bg-gray-50 text-gray-400 text-[10px] uppercase font-bold tracking-widest">
                                <tr>
                                    <th class="p-4">Data</th>
                                    <th class="p-4">Paciente</th>
                                    <th class="p-4">Médico</th>
                                    <th class="p-4">Info</th>
                                    <th class="p-4">Status</th>
                                    <th class="p-4 text-right">Ação</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm">
                                {% for c in consultas %}
                                <tr class="border-b border-gray-50 hover:bg-gray-50/50 transition">
                                    <td class="p-4 font-bold">{{ c.data_hora.strftime('%d/%m %H:%M') }}</td>
                                    <td class="p-4">{{ c.paciente.nome }}</td>
                                    <td class="p-4 text-gray-500">{{ c.dentista.nome }}</td>
                                    <td class="p-4 text-xs text-gray-500">{{ c.servico }} ({{ c.tipo_consulta }})</td>
                                    <td class="p-4">
                                        <span class="px-2 py-1 rounded text-[10px] font-bold uppercase {{ 'bg-green-100 text-green-700' if c.status == 'Confirmado' or c.status == 'Agendado' else 'bg-red-100 text-red-600' }}">
                                            {{ c.status }}
                                        </span>
                                    </td>
                                    <td class="p-4 text-right">
                                        {% if 'Cancelado' not in c.status %}
                                        <form method="POST" class="inline">
                                            <input type="hidden" name="acao" value="cancelar_consulta">
                                            <input type="hidden" name="id_agendamento" value="{{ c.id }}">
                                            <button class="text-xs font-bold text-red-400 hover:text-red-600 border border-red-100 px-3 py-1 rounded hover:bg-red-50">Cancelar</button>
                                        </form>
                                        {% else %}
                                        <span class="text-gray-300">-</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </main>
</body>
</html>